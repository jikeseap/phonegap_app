<!DOCTYPE HTML>
 <html>
 	 <head>
 	 	 <meta name="viewport" content="width=320; user-scalable=no" />
 	 	  <meta http-equiv="Content-type" content="text/html; charset=utf-8">
 	 	   <title>contact</title>
 	 	   <script type="text/javascript" charset="utf-8" src="cordova.js"></script>
 	 	   <script>
 	 	    
 	 	   function init(){ 
 	 	   	document.addEventListener("deviceready", startup); 
 	 	   	} 
 	 	   
 	 	   function startup(){ 
 	 	   	document.getElementById("searchButton").addEventListener("click", handleSearch); 
 	 	   	} 
 	 	   
 	 	   function handleSearch(e){
 	 	   	 var search = document.getElementById("name").value; //What parts of the contact we will search 
 	 	   	 var fields = ["displayName", "phoneNumbers"]; //Options for the search 
 	 	   	 var options = new ContactFindOptions(); 
 	 	   	 options.filter = search; 
 	 	   	 options.multiple = true; 
 	 	   	 document.getElementById("results").innerHTML="Searching..."; 
 	 	   	 navigator.contacts.find(fields, contactSuccess, contactError, options); 
 	 	   	 } 
 	 	   	 
 	 	   	 function contactError(e){ 
 	 	   	 	document.getElementById("results").innerHTML=""; 
 	 	   	 	navigator.notification.alert("Sorry, an error was thrown!"); 
 	 	   	 	} 
 	 	   	 	
 	 	   	 function contactSuccess(results){
 	 	   	 	if(results.length==0){
 	 	   	 		document.getElementById("results").innerHTML=""; 
 	 	   	 		showConfirm();
 	 	   	 	}
 	 	   	 	else{
 	 	   	 	//finding contact
 	 	   	 	var s = "";
 	 	   	 	var m = "";
 	 	   	 	for (var i = 0; i < results.length; i++) {
 	 	   	 		 s += "<p>"+results[i].displayName+"</p>";
 	 	   	 		 m += "<p>"+results[i].phoneNumbers+"</p>";
 	 	   	 		 }
 	 	   	 		 document.getElementById("results").innerHTML=s;
 	 	   	 		 document.getElementById("results").innerHTML=m;
 	 	   	 		}
 	 	   	 	} 
 	 	   	 	
 	 	   	 	
 	 	   	 	// Show a custom confirmation dialog
 	 	   	 	function showConfirm(){
 	 	   	 		navigator.notification.confirm(
 	 	   	 			'Would you like to add a new contact', // message
 	 	   	 			onConfirm,            // callback to invoke with index of button pressed
 	 	   	 			'add new contact',           // title
 	 	   	 			['Yes','No']         // buttonLabels
 	 	   	 			);
 	 	   	 		}
 	 	   	 		
 	 	   	  	function onConfirm(buttonIndex) {
			if (buttonIndex == 0 || buttonIndex == 2){
				//If cancel or back exit app
				navigator.app.exitApp();
			}else {
				//else use localStorage to save contact name and go to next page
				window.localStorage.setItem("contact_name", contact_name);
				window.location = "page_4.html";
			}
		}
 	 	 </script> 
 	 	 </head> 
 	 	 <body onload="init()"> 
 	 	 	<h1>Contact Search</h1> 
 	 	 	<form> 
 	 	 		<input type="text" id="name"><br/> 
 	 	 		<input type="button" id="searchButton" value="Search"> 
 	 	 		<div id="results"></div> 
 	 	 		</form>
 	 	 </body> 
</html>

